<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RSA μ•”νΈν™” μ„±λ¥ λ¶„μ„ μ‹λ®¬λ μ΄μ…</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #e0f2fe 0%, #ddd6fe 100%);
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        h1 {
            font-size: 2rem;
            color: #1f2937;
            margin-bottom: 10px;
        }
        
        .subtitle {
            color: #6b7280;
            margin-bottom: 30px;
        }
        
        button {
            background: #4f46e5;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            margin-bottom: 30px;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: background 0.3s;
        }
        
        button:hover:not(:disabled) {
            background: #4338ca;
        }
        
        button:disabled {
            background: #9ca3af;
            cursor: not-allowed;
        }
        
        .chart-section {
            background: #f9fafb;
            padding: 24px;
            border-radius: 12px;
            margin-bottom: 24px;
        }
        
        .chart-title {
            font-size: 1.25rem;
            font-weight: bold;
            color: #1f2937;
            margin-bottom: 16px;
        }
        
        .chart-container {
            position: relative;
            height: 300px;
            margin-bottom: 16px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 16px;
        }
        
        th {
            background: #f3f4f6;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            border-bottom: 2px solid #e5e7eb;
        }
        
        td {
            padding: 12px;
            border-bottom: 1px solid #e5e7eb;
        }
        
        tr:hover {
            background: #f9fafb;
        }
        
        .insights {
            background: linear-gradient(135deg, #e0e7ff 0%, #f3e8ff 100%);
            padding: 24px;
            border-radius: 12px;
            margin-top: 24px;
        }
        
        .insight-box {
            background: white;
            padding: 16px;
            border-radius: 8px;
            margin-bottom: 16px;
        }
        
        .insight-box h3 {
            font-size: 1.1rem;
            margin-bottom: 8px;
        }
        
        .red { color: #dc2626; }
        .purple { color: #9333ea; }
        .blue { color: #2563eb; }
        .green { color: #16a34a; }
        
        .footer {
            text-align: center;
            color: #6b7280;
            font-size: 0.875rem;
            margin-top: 24px;
        }
        
        .loading {
            display: none;
            color: #4f46e5;
            font-weight: 600;
            margin-left: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>π” RSA μ•”νΈν™” μ„±λ¥ λ¶„μ„ μ‹λ®¬λ μ΄μ…</h1>
        <p class="subtitle">λΉ„νΈ μ μ¦κ°€μ— λ”°λ¥Έ μ•”νΈν™”, λ³µνΈν™”, μ†μΈμλ¶„ν•΄ μ‹κ°„ λΉ„κµ</p>
        
        <button id="startBtn" onclick="runSimulation()">
            β–¶οΈ μ‹λ®¬λ μ΄μ… μ‹μ‘
            <span class="loading" id="loading"></span>
        </button>
        
        <div id="results" style="display: none;">
            <!-- μ•”νΈν™” vs λ³µνΈν™” μ°¨νΈ -->
            <div class="chart-section">
                <h2 class="chart-title">π“ μ•”νΈν™” vs λ³µνΈν™” μ‹¤ν–‰ μ‹κ°„</h2>
                <div class="chart-container">
                    <canvas id="encDecChart"></canvas>
                </div>
            </div>
            
            <!-- μ†μΈμλ¶„ν•΄ μ°¨νΈ -->
            <div class="chart-section">
                <h2 class="chart-title">π”“ μ†μΈμλ¶„ν•΄ κ³µκ²© μ‹κ°„ (Trial Division)</h2>
                <div class="chart-container">
                    <canvas id="factorChart"></canvas>
                </div>
            </div>
            
            <!-- λ°μ΄ν„° ν…μ΄λΈ” -->
            <div class="chart-section">
                <h2 class="chart-title">π“ μƒμ„Έ λ¶„μ„ λ°μ΄ν„°</h2>
                <table>
                    <thead>
                        <tr>
                            <th>λΉ„νΈ μ</th>
                            <th style="text-align: right;">μ•”νΈν™” (ms)</th>
                            <th style="text-align: right;">λ³µνΈν™” (ms)</th>
                            <th style="text-align: right;">λ³µνΈν™”/μ•”νΈν™” λΉ„μ¨</th>
                            <th style="text-align: right;">μ†μΈμλ¶„ν•΄ (ms)</th>
                        </tr>
                    </thead>
                    <tbody id="dataTable"></tbody>
                </table>
            </div>
            
            <!-- μΈμ‚¬μ΄νΈ -->
            <div class="insights">
                <h2 style="margin-bottom: 16px; font-size: 1.5rem;">π― ν•µμ‹¬ μΈμ‚¬μ΄νΈ</h2>
                
                <div class="insight-box">
                    <h3 class="red">π”΄ λ³µνΈν™”κ°€ μ•”νΈν™”λ³΄λ‹¤ λλ¦° μ΄μ </h3>
                    <p>λ³µνΈν™”μ— μ‚¬μ©λλ” κ°μΈν‚¤ dλ” λ§¤μ° ν° μμ…λ‹λ‹¤. λ³µνΈν™”λ” c^d mod n μ—°μ‚°μ„ μν–‰ν•λ”λ°, dκ°€ ν¬κΈ° λ•λ¬Έμ— λ” λ§μ€ κ³±μ… μ—°μ‚°μ΄ ν•„μ”ν•©λ‹λ‹¤. λ°λ©΄ μ•”νΈν™”λ” e=65537λ΅ κ³ μ •λ μ‘μ€ κ°’μ„ μ‚¬μ©ν•μ—¬ λΉ λ¦…λ‹λ‹¤.</p>
                    <p style="margin-top: 8px; font-size: 0.875rem; color: #6b7280;">
                        ν‰κ·  λ³µνΈν™”/μ•”νΈν™” λΉ„μ¨: <span class="red" style="font-weight: bold;" id="avgRatio">-</span>
                    </p>
                </div>
                
                <div class="insight-box">
                    <h3 class="purple">π£ μ†μΈμλ¶„ν•΄μ κΈ°ν•κΈ‰μμ  μ¦κ°€</h3>
                    <p>λΉ„νΈ μκ°€ μ¦κ°€ν• μλ΅ μ†μΈμλ¶„ν•΄ μ‹κ°„μ΄ κΈ°ν•κΈ‰μμ μΌλ΅ μ¦κ°€ν•©λ‹λ‹¤. μ΄κ²ƒμ΄ RSA λ³΄μ•μ„±μ ν•µμ‹¬μ…λ‹λ‹¤. n = p Γ— qλ¥Ό μ•μ•„λ„ pμ™€ qλ¥Ό μ°Ύλ” κ²ƒμ€ λ§¤μ° μ–΄λ µμµλ‹λ‹¤.</p>
                </div>
                
                <div class="insight-box">
                    <h3 class="blue">π”µ ν„μ‹¤μ—μ„ 2048bitλ¥Ό μ‚¬μ©ν•λ” μ΄μ </h3>
                    <ul style="list-style-position: inside; padding-left: 0;">
                        <li>1024bit μ΄ν•: ν„λ€ μ»΄ν“¨ν„°λ΅ μ†μΈμλ¶„ν•΄ κ°€λ¥ (μμΌ~μκ°μ›”)</li>
                        <li>2048bit: ν„μ¬ κ¶μ¥ ν‘μ¤€, μνΌμ»΄ν“¨ν„°λ΅λ„ μμ‹­~μλ°±λ…„ μ†μ”</li>
                        <li>4096bit: μ¥κΈ° λ³΄μ•μ΄ ν•„μ”ν• κ²½μ°, ν•μ§€λ§ μ—°μ‚° μ‹κ°„ μ¦κ°€</li>
                    </ul>
                    <p style="margin-top: 8px; font-size: 0.75rem; color: #6b7280;">
                        * μ‹¤μ λ΅λ” λ” ν¨μ¨μ μΈ μ†μΈμλ¶„ν•΄ μ•κ³ λ¦¬μ¦(GNFS λ“±)μ΄ μ‚¬μ©λμ§€λ§, ν° λΉ„νΈ μμ—μ„λ” μ—¬μ „ν κ³„μ‚° λ¶κ°€λ¥
                    </p>
                </div>
                
                <div class="insight-box">
                    <h3 class="green">πΆ RSAμ λΉ„λ€μΉ­μ„±</h3>
                    <p>μ•”νΈν™”λ” λΉ λ¥΄κ³  λ³µνΈν™”λ” λλ¦° κµ¬μ΅° λ•λ¶„μ—, κ³µκ°ν‚¤λ΅ λ„κµ¬λ‚ μ•”νΈν™”ν•  μ μμ§€λ§ κ°μΈν‚¤κ°€ μ—†μΌλ©΄ λ³µνΈν™”κ°€ μ–΄λ µμµλ‹λ‹¤. μ΄κ²ƒμ΄ κ³µκ°ν‚¤ μ•”νΈμ ν•µμ‹¬ μ›λ¦¬μ…λ‹λ‹¤.</p>
                </div>
            </div>
        </div>
        
        <p class="footer">β οΈ μ΄ μ‹λ®¬λ μ΄μ…μ€ κµμ΅ λ©μ μΌλ΅ λ‹¨μν™”λ λ²„μ „μ…λ‹λ‹¤. μ‹¤μ  RSAλ” λ” ν° ν‚¤ ν¬κΈ°μ™€ μ•μ „ν• λ‚μ μƒμ„±μ„ μ‚¬μ©ν•©λ‹λ‹¤.</p>
    </div>
    
    <script>
        let encDecChart, factorChart;
        
        // RSA μ•κ³ λ¦¬μ¦ ν•¨μλ“¤
        function isPrime(n) {
            if (n <= 1) return false;
            if (n <= 3) return true;
            if (n % 2 === 0 || n % 3 === 0) return false;
            for (let i = 5; i * i <= n; i += 6) {
                if (n % i === 0 || n % (i + 2) === 0) return false;
            }
            return true;
        }
        
        function generatePrime(bits) {
            const min = Math.pow(2, bits - 1);
            const max = Math.pow(2, bits) - 1;
            let candidate;
            do {
                candidate = Math.floor(Math.random() * (max - min + 1)) + min;
                if (candidate % 2 === 0) candidate++;
            } while (!isPrime(candidate));
            return candidate;
        }
        
        function modPow(base, exp, mod) {
            let result = 1;
            base = base % mod;
            while (exp > 0) {
                if (exp % 2 === 1) result = (result * base) % mod;
                exp = Math.floor(exp / 2);
                base = (base * base) % mod;
            }
            return result;
        }
        
        function extGCD(a, b) {
            if (b === 0) return { gcd: a, x: 1, y: 0 };
            const result = extGCD(b, a % b);
            return { 
                gcd: result.gcd, 
                x: result.y, 
                y: result.x - Math.floor(a / b) * result.y 
            };
        }
        
        function modInverse(e, phi) {
            const { gcd, x } = extGCD(e, phi);
            if (gcd !== 1) return null;
            return ((x % phi) + phi) % phi;
        }
        
        function factorize(n) {
            const start = performance.now();
            let count = 0;
            for (let i = 2; i <= Math.sqrt(n); i++) {
                count++;
                if (n % i === 0) {
                    return { time: performance.now() - start, iterations: count };
                }
            }
            return { time: performance.now() - start, iterations: count };
        }
        
        function simulateRSA(bits) {
            const p = generatePrime(Math.floor(bits / 2));
            const q = generatePrime(Math.floor(bits / 2));
            const n = p * q;
            const phi = (p - 1) * (q - 1);
            const e = 65537;
            const d = modInverse(e, phi);
            
            const message = Math.floor(Math.random() * (n - 1)) + 1;
            
            const encStart = performance.now();
            const ciphertext = modPow(message, e, n);
            const encTime = performance.now() - encStart;
            
            const decStart = performance.now();
            const decrypted = modPow(ciphertext, d, n);
            const decTime = performance.now() - decStart;
            
            const { time: factorTime } = factorize(n);
            
            return {
                bits,
                encTime,
                decTime,
                factorTime,
                ratio: decTime / encTime
            };
        }
        
        async function runSimulation() {
            const btn = document.getElementById('startBtn');
            const loading = document.getElementById('loading');
            const results = document.getElementById('results');
            
            btn.disabled = true;
            loading.style.display = 'inline';
            loading.textContent = 'μ‹λ®¬λ μ΄μ… μ¤‘...';
            
            const bitSizes = [8, 10, 12, 14, 16, 18, 20, 22, 24];
            const data = [];
            
            for (let bits of bitSizes) {
                loading.textContent = `μ‹λ®¬λ μ΄μ… μ¤‘... (${bits} bits)`;
                await new Promise(resolve => setTimeout(resolve, 100));
                
                // 3λ² μΈ΅μ •ν•μ—¬ ν‰κ· 
                let avgEncTime = 0, avgDecTime = 0, avgFactorTime = 0, avgRatio = 0;
                for (let i = 0; i < 3; i++) {
                    const result = simulateRSA(bits);
                    avgEncTime += result.encTime;
                    avgDecTime += result.decTime;
                    avgFactorTime += result.factorTime;
                    avgRatio += result.ratio;
                }
                
                data.push({
                    bits,
                    encTime: (avgEncTime / 3).toFixed(4),
                    decTime: (avgDecTime / 3).toFixed(4),
                    factorTime: (avgFactorTime / 3).toFixed(4),
                    ratio: (avgRatio / 3).toFixed(2)
                });
            }
            
            displayResults(data);
            
            btn.disabled = false;
            loading.style.display = 'none';
            results.style.display = 'block';
        }
        
        function displayResults(data) {
            // μ°¨νΈ κ·Έλ¦¬κΈ°
            const labels = data.map(d => d.bits + ' bits');
            const encTimes = data.map(d => parseFloat(d.encTime));
            const decTimes = data.map(d => parseFloat(d.decTime));
            const factorTimes = data.map(d => parseFloat(d.factorTime));
            
            // μ•”νΈν™”/λ³µνΈν™” μ°¨νΈ
            if (encDecChart) encDecChart.destroy();
            const ctx1 = document.getElementById('encDecChart').getContext('2d');
            encDecChart = new Chart(ctx1, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        {
                            label: 'μ•”νΈν™” μ‹κ°„',
                            data: encTimes,
                            borderColor: '#10b981',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            tension: 0.3,
                            borderWidth: 2
                        },
                        {
                            label: 'λ³µνΈν™” μ‹κ°„',
                            data: decTimes,
                            borderColor: '#ef4444',
                            backgroundColor: 'rgba(239, 68, 68, 0.1)',
                            tension: 0.3,
                            borderWidth: 2
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'top' }
                    },
                    scales: {
                        y: {
                            title: { display: true, text: 'μ‹¤ν–‰ μ‹κ°„ (ms)' }
                        }
                    }
                }
            });
            
            // μ†μΈμλ¶„ν•΄ μ°¨νΈ
            if (factorChart) factorChart.destroy();
            const ctx2 = document.getElementById('factorChart').getContext('2d');
            factorChart = new Chart(ctx2, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'μ†μΈμλ¶„ν•΄ μ‹κ°„',
                        data: factorTimes,
                        borderColor: '#9333ea',
                        backgroundColor: 'rgba(147, 51, 234, 0.1)',
                        tension: 0.3,
                        borderWidth: 3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'top' }
                    },
                    scales: {
                        y: {
                            type: 'logarithmic',
                            title: { display: true, text: 'μ†μΈμλ¶„ν•΄ μ‹κ°„ (ms, λ΅κ·Έ)' }
                        }
                    }
                }
            });
            
            // ν…μ΄λΈ” μ±„μ°κΈ°
            const tableBody = document.getElementById('dataTable');
            tableBody.innerHTML = '';
            data.forEach(row => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td style="font-weight: 600;">${row.bits} bits</td>
                    <td style="text-align: right; color: #16a34a;">${row.encTime}</td>
                    <td style="text-align: right; color: #dc2626;">${row.decTime}</td>
                    <td style="text-align: right; font-weight: bold;">${row.ratio}x</td>
                    <td style="text-align: right; color: #9333ea;">${row.factorTime}</td>
                `;
                tableBody.appendChild(tr);
            });
            
            // ν‰κ·  λΉ„μ¨ κ³„μ‚°
            const avgRatio = data.reduce((sum, d) => sum + parseFloat(d.ratio), 0) / data.length;
            document.getElementById('avgRatio').textContent = avgRatio.toFixed(1) + 'λ°°';
        }
    </script>
</body>
</html>